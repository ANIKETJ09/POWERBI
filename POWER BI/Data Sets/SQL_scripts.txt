CREATE DATABASE FLIPKART_DB; #COMMAND USED TO CREATE A DATABASE

DROP DATABASE EBAY_DB;#COMMAND USED TO DROP A DATABASE

SELECT DATABASE();#COMMAND IS USED TO CHECK WHICH DATABASE IS ACTIVE

SHOW TABLES; #COMMAND USED TO DISPLAY ALL TABLES IN A DATABASE

USE FLIPKART_DB; #COMMAND USED TO MAKE DATABASE ACTIVE


DROP TABLE CUSTOMER_TB;
#creating a table	
CREATE TABLE CUSTOMER_TB
(
CUST_NAME VARCHAR(20),
CUST_ADDR VARCHAR(30),
CUST_PHNUM INT(10)
);

CREATE TABLE CUSTOMER_TB
(
CUST_NAME VARCHAR(20),
CUST_ADDR VARCHAR(30),
CUST_PHNUM INT(10),
CUST_AGE INT, 
CUST_GENDER CHAR(1)
);

SELECT * FROM CUSTOMER_TB;     #DISPLAYS ALL CONTENT IN A TABLE

INSERT INTO CUSTOMER_TB VALUES ('SANTHOSH', 'BANGALORE',123654);
INSERT INTO CUSTOMER_TB VALUES ('ANAND','MUMBAI', 1254789632);
INSERT INTO CUSTOMER_TB (CUST_NAME, CUST_ADDR, CUST_PHNUM) VALUES ('DINESH','CHENNAI',1239874560);
INSERT INTO CUSTOMER_TB VALUES ('SATISH','DELHI', NULL);
INSERT INTO CUSTOMER_TB (CUST_NAME, CUST_ADDR,CUST_PHNUM) VALUES ('HEMA','PUNE',123098);


INSERT INTO CUSTOMER_TB VALUES ('SANTHOSH', 'BANGALORE',123654, 28, 'M');
INSERT INTO CUSTOMER_TB VALUES ('ANAND','MUMBAI', 1254789632, 26, 'M' );
INSERT INTO CUSTOMER_TB (CUST_NAME, CUST_ADDR, CUST_PHNUM, CUST_AGE, CUST_GENDER) VALUES ('DINESH','CHENNAI',1239874560, 30, 'M');
INSERT INTO CUSTOMER_TB VALUES ('SATISH','DELHI', NULL, NULL, 'M');
INSERT INTO CUSTOMER_TB (CUST_NAME, CUST_ADDR,CUST_PHNUM,CUST_AGE, CUST_GENDER) VALUES ('HEMA','PUNE',123098,25, 'F');



INSERT INTO CUSTOMER_TB(CUST_ADDR, CUST_NAME, CUST_PHNUM) VALUES ('BANGALORE', 'SANTOSH22',1234567890);


INSERT INTO CUSTOMER_TB VALUES ('SATISH','DELHI', 0000);


INSERT INTO CUSTOMER_TB VALUES ('AVINASH' ,'            ' , 1236541203);



INSERT INTO CUSTOMER_TB (CUST_NAME, CUST_ADDR) VALUES ('HEMA','PUNE');

INSERT INTO CUSTOMER_TB (CUST_NAME, CUST_ADDR,CUST_PHNUM) VALUES ('HEMA','PUNE',123098);



INSERT INTO CUSTOMER_TB (CUST_NAME, CUST_PHNUM) VALUES ('KISHORE', 1236547410);



DROP TABLE CUSTOMER_TB;


UPDATE CUSTOMER_TB SET CUST_PHNUM = 1010101010;

UPDATE CUSTOMER_TB SET CUST_ADDR = 'HYDERABAD'
WHERE CUST_NAME = 'DINESH';


UPDATE CUSTOMER_TB SET CUST_AGE = 28 WHERE CUST_NAME = 'SANTHOSH';
UPDATE CUSTOMER_TB SET CUST_AGE = 26 WHERE CUST_NAME = 'ANAND';



UPDATE CUSTOMER_TB SET CUST_AGE = 26, CUST_GENDER = 'F' WHERE CUST_NAME = 'HEMA';

UPDATE CUSTOMER_TB SET CUST_GENDER = 'M' WHERE CUST_NAME = 'ANAND';

UPDATE CUSTOMER_TB SET CUST_GENDER = 'M' WHERE 
CUST_NAME IN ( 'ANAND', 'DINESH','SATISH');




SELECT * FROM CUSTOMER_TB;

DELETE FROM CUSTOMER_TB WHERE CUST_NAME = 'SANTHOSH';

DELETE FROM CUSTOMER_TB;


#CHANGES I AM DOING TO EXISTING TABLE
ALTER TABLE CUSTOMER_TB ADD COLUMN CUST_AGE INT;
ALTER TABLE CUSTOMER_TB ADD COLUMN CUST_GENDER CHAR(1);
ALTER TABLE CUSTOMER_TB DROP COLUMN CUST_GENDER;

ALTER TABLE CUSTOMER_TB RENAME COLUMN CUST_AGE TO AGE;





-------------------------------------------------------------------------------------------------------------------
USE FLIPKART_DB;

SELECT * FROM PHONE_NUMBERS;

###############IMP###########################
DROP TABLE PHONE_NUMBERS;
DELETE FROM PHONE_NUMBERS; # DELETE FROM PHONE_NUMBERS WHERE NAME="SANTHOSH";
TRUNCATE TABLE PHONE_NUMBERS;
#############################################
SELECT DATABASE();
SHOW TABLES;
DROP TABLE  PHONE_NUMBERS;
DROP TABLE IF EXISTS PHONE_NUMBERS;

CREATE TABLE PHONE_NUMBERS (
NAME VARCHAR(50),
PHONE_NUMBER INT
);

CREATE TABLE PHONE_NUMBERS_1 (
NAME VARCHAR(50),
PHONE_NUMBER BIGINT
);

CREATE TABLE PHONE_NUMBERS_2 (
NAME VARCHAR(50),
PHONE_NUMBER INT
);


SELECT * FROM PHONE_NUMBERS_1;
SELECT * FROM PHONE_NUMBERS;

INSERT INTO PHONE_NUMBERS VALUES('Bala',1236598500);

INSERT INTO PHONE_NUMBERS VALUES('Santhosh',1239638520);



INSERT INTO PHONE_NUMBERS_1 VALUES('Bala',7896541230);
INSERT INTO PHONE_NUMBERS_1 VALUES('Santhosh',1239638520);


SELECT * FROM PHONE_NUMBERS_1;
SELECT * FROM FLIPKART_DB.PHONE_NUMBERS;

USE KSR_SQL;
SELECT * FROM CAR_DATA;
SELECT * FROM KSR_SQL.CAR_DATA;


GRANT SELECT ON FLIPKART_DB.PHONE_NUMBERS_1 TO VINAY;
GRANT INSERT ON FLIPKART_DB.PHONE_NUMBERS_1 TO VINAY;
GRANT DELETE ON FLIPKART_DB.PHONE_NUMBERS_1 TO SEPT_TEAM;


GRANT SELECT ON FLIPKART_DB.PHONE_NUMBERS_1 TO HARISH;

REVOKE SELECT ON PHONE_NUMBERS_1 FROM VINAY;


SELECT * FROM PHONE_NUMBERS_1;

UPDATE PHONE_NUMBERS_1 SET PHONE_NUMBER = 99999 WHERE 
NAME = 'BALA';

UPDATE PHONE_NUMBERS_1 SET PHONE_NUMBER = 99999 WHERE 
NAME IN ( 'BALA','KIRAN','SANTHOSH');

SELECT USER();

SET SQL_SAFE_UPDATES = 0;


--------------------------------------------------

SET AUTOCOMMIT = 0; #BY DEFAULT MYSQL IS AUTO COMMIT, SO SETTING TO 0, SO THAT I HAVE CONTROL



SELECT DATABASE();

SHOW TABLES;



DROP TABLE IF EXISTS TCL_TB;
CREATE TABLE TCL_TB (
ID INT,
NAME VARCHAR(20),
AGE INT
);

SELECT * FROM TCL_TB;

SET AUTOCOMMIT=0;

SELECT * FROM TCL_TB;
INSERT INTO TCL_TB VALUES (1,'RAJA',25);
INSERT INTO TCL_TB VALUES (2,'ANIL',26);
INSERT INTO TCL_TB VALUES (3,'RAMU',24);
INSERT INTO TCL_TB VALUES (4,'ANAD',22);
INSERT INTO TCL_TB VALUES (5,'HARI',20);


SELECT * FROM TCL_TB;


START TRANSACTION;    #START OF CODE
DELETE FROM TCL_TB;
SELECT * FROM TCL_TB;
ROLLBACK;
SELECT * FROM TCL_TB;



START TRANSACTION;    #START OF CODE
DELETE FROM TCL_TB WHERE NAME='RAJA';
SELECT * FROM TCL_TB;
ROLLBACK;
SELECT * FROM TCL_TB;



START TRANSACTION;#25 and 26
UPDATE TCL_TB SET AGE = 99 WHERE NAME ='RAJA'; 
UPDATE TCL_TB SET AGE = 99 WHERE NAME ='ANIL';   
SELECT * FROM TCL_TB;
ROLLBACK;
SELECT * FROM TCL_TB;

START TRANSACTION;
SAVEPOINT A;
INSERT INTO TCL_TB VALUES(6, 'NEW PERSON',25);
SELECT * FROM TCL_TB;
SAVEPOINT B;
UPDATE TCL_TB SET AGE = 99 WHERE NAME ='RAMU';
SELECT * FROM TCL_TB;
SAVEPOINT C;
DELETE FROM TCL_TB WHERE ID = 1;
DELETE FROM TCL_TB WHERE ID = 2;
DELETE FROM TCL_TB WHERE ID = 3;
SELECT * FROM TCL_TB;
ROLLBACK TO A;
SELECT * FROM TCL_TB;




SELECT * FROM TCL_TB;
START TRANSACTION;
SAVEPOINT X;
ALTER TABLE TCL_TB ADD COLUMN COMPANY VARCHAR(20); #DDL #COMMIT
SELECT * FROM TCL_TB;
SAVEPOINT Y;
UPDATE TCL_TB SET COMPANY='TCS'; #DML
SELECT * FROM TCL_TB;
ROLLBACK TO Y;
SELECT * FROM TCL_TB;

START TRANSACTION;
SELECT * FROM TCL_TB;
UPDATE TCL_TB SET AGE = 100 WHERE ID = 1;
UPDATE TCL_TB SET AGE = 100 WHERE ID = 2;
SELECT * FROM TCL_TB;
COMMIT;  #CONFIRMED TO DATABASE..TELLING THAT.. THIS IS CORRECT
UPDATE TCL_TB SET AGE = 100 WHERE ID = 3;
UPDATE TCL_TB SET AGE = 100 WHERE ID = 4;
SELECT * FROM TCL_TB;
ROLLBACK;
SELECT * FROM TCL_TB;


-----------------------------------------------------


SELECT DATABASE();


DROP TABLE IF EXISTS CUSTUMER_INFO;
CREATE TABLE CUSTUMER_INFO (
ID INT,
FIRST_NAME VARCHAR(20),
LAST_NAME VARCHAR(20),
AGE TINYINT,
ADDRESS VARCHAR(200),
LOCATION VARCHAR(10),
PHONE_NUMBER BIGINT
);

INSERT INTO CUSTUMER_INFO VALUES (1,'SANTHOSH','J',28,'#32,WHITEFIELD, BANGALORE','INDIA',7892213354);
INSERT INTO CUSTUMER_INFO VALUES (1,'SANTHOSH','SANTHOSH',-12,'#32,WHITEFIELD, BANGALORE','INDIA',90359); # 3 ERRORS
INSERT INTO CUSTUMER_INFO VALUES (1,' ','J',5,'#32,WHITEFIELD, BANGALORE','INDIA',90359);  # 3 ERRORS


SELECT * FROM CUSTUMER_INFO; 
#ROW 2 --->ID, FIRST<>LAST, AGE (-), PHONENUMBER (4 ERRORS)
#ROW 3 ---> ID, FIRST_NAME, AGE, PHONENUMBER (4 ERRORS)



DROP TABLE IF EXISTS CUSTUMER_INFO_1;
CREATE TABLE CUSTUMER_INFO_1
 (
ID INT,
FIRST_NAME VARCHAR(20) NOT NULL,  
LAST_NAME VARCHAR(20),
AGE TINYINT CONSTRAINT AGE_LIM1 CHECK (AGE> 18),
ADDRESS VARCHAR(100)  UNIQUE,
LOCATION VARCHAR(10) DEFAULT 'INDIA',
PHONE_NUMBER BIGINT CONSTRAINT PHON_CHECK CHECK(LENGTH(PHONE_NUMBER)=10),
CONSTRAINT FN_LN_CHECK CHECK(FIRST_NAME <> LAST_NAME),
CONSTRAINT PK_ID PRIMARY KEY (ID),
CONSTRAINT UNIQUE_PHONE_UK UNIQUE (PHONE_NUMBER)
);

SELECT * FROM CUSTUMER_INFO_1;
INSERT INTO CUSTUMER_INFO_1 VALUES (1,'SANTHOSH','J',28,'#32,WHITEFIELD, BANGALORE','KARNATAKA',7892213354);
INSERT INTO CUSTUMER_INFO_1 VALUES (2,'DINESH','KUMAR',30,'#33,PORUR, CHENNAI','TAMIL NADU',7892213999);
INSERT INTO CUSTUMER_INFO_1 VALUES (3,'SATISH','KULKARNI',30,'#34,PORUR, CHENNAI','TAMIL NADU',9874213977);
INSERT INTO CUSTUMER_INFO_1 VALUES (4,'DIYA','KUMAARI',25,'#35,WHITEFIELD, BANGALORE','KARNATAKA',9874213911);
INSERT INTO CUSTUMER_INFO_1 VALUES (5,'HEMA','JI',25,'#36,WHITEFIELD, BANGALORE','KARNATAKA',9852213988);
INSERT INTO CUSTUMER_INFO_1 VALUES (6,'SURESH','KUMAR',19,'#39,WHITEFIELD, BANGALORE','KARNATAKA',9854123975);
INSERT INTO CUSTUMER_INFO_1 VALUES (8,'RAHUL','KALA',19,'#85,WHITEFIELD, BANGALORE',NULL,9854123111);


INSERT INTO CUSTUMER_INFO_1 (ID, FIRST_NAME, LAST_NAME, AGE, ADDRESS, PHONE_NUMBER)
VALUES (7,'SANGEETA','KUMARI',24,'#40,WHITEFIELD, BANGALORE',8521479630);

INSERT INTO CUSTUMER_INFO_1 (ID, LAST_NAME, AGE, ADDRESS, PHONE_NUMBER)
VALUES (7,'KUMARI',24,'#45,WHITEFIELD, BANGALORE',8585679630);



SELECT * FROM CAR_DATA; #THIS IS TO SEE ALL RECORDS, * MEANS EVERYTHING

SELECT CAR_NAME, YEAR, KMS_DRIVEN,SELLING_PRICE FROM CAR_DATA; #SELECTED COLUMNS

SELECT COUNT(*) FROM CAR_DATA;

SELECT * FROM CAR_DATA WHERE YEAR=2016;

SELECT COUNT(*) FROM CAR_DATA WHERE YEAR=2016; #50 CARS
SELECT COUNT(*) FROM CAR_DATA WHERE YEAR=2014; #38 CARS


SELECT * FROM CAR_DATA;
SELECT * FROM CAR_DATA ORDER BY KMS_DRIVEN; #BYDEFAULT ITS SORTING IN ASC
SELECT * FROM CAR_DATA ORDER BY KMS_DRIVEN ASC; 
SELECT * FROM CAR_DATA ORDER BY KMS_DRIVEN DESC;


SELECT * FROM CAR_DATA ORDER BY SELLING_PRICE DESC;



SELECT * FROM CAR_DATA WHERE YEAR=2015 AND FUEL_TYPE ='DIESEL';
SELECT COUNT(*) FROM CAR_DATA WHERE YEAR=2015 AND FUEL_TYPE ='DIESEL';#15


SELECT * FROM CAR_DATA WHERE YEAR = 2014;

SELECT * FROM CAR_DATA WHERE YEAR IN (2014,2015);

SELECT COUNT(*) FROM CAR_DATA WHERE YEAR IN (2014,2015);


SELECT * FROM CAR_DATA WHERE KMS_DRIVEN > 200000;

#2003 TO 2018 (15 YEARS) 2005 TO 2015 (10 YEARS)
SELECT * FROM CAR_DATA WHERE YEAR IN (2014,2015,2016,2017,2018);
SELECT * FROM CAR_DATA WHERE YEAR IN (2014,2015,2016,2017,2018) ORDER BY YEAR;
SELECT * FROM CAR_DATA  ORDER BY YEAR;

SELECT * FROM CAR_DATA WHERE YEAR BETWEEN 2010 AND 2015;

SELECT COUNT(*) FROM CAR_DATA WHERE YEAR BETWEEN 2010 AND 2015; #189

SELECT COUNT(*) FROM CAR_DATA WHERE YEAR > 2010 AND YEAR < 2015;#189




#1975 TO 2020 (45 YEARS) (1980 TILL 2010) {30}
SELECT * FROM CAR_DATA WHERE YEAR IN (2014,2015,2016,2017,2018);

SELECT * FROM CAR_DATA WHERE YEAR NOT IN (2003,2004,2005,2008);
#2003,2004,2005,2018


#SHOW ME ALL CARS FROM 2007 TO 2015 (EXLUDING 2008)
SELECT COUNT(*) FROM CAR_DATA WHERE YEAR IN (2007,2008,2009,2010,2011,2012,2013,2014,2015);#204
SELECT COUNT(*) FROM CAR_DATA WHERE YEAR BETWEEN 2007 AND 2015;#204
SELECT COUNT(*) FROM CAR_DATA WHERE YEAR IN (2007,2009,2010,2011,2012,2013,2014,2015);#197
SELECT COUNT(*) FROM CAR_DATA WHERE YEAR BETWEEN 2007 AND 2015 AND YEAR NOT IN (2008);#197

SELECT * FROM CAR_DATA WHERE CAR_NAME = 'RITZ' AND YEAR= 2011 AND FUEL_TYPE="PETROL";

	SELECT * FROM CAR_DATA ORDER BY YEAR DESC;#(2003 - 2018)
    
    SELECT MAX(YEAR) FROM CAR_DATA; #LATEST MODEL CAR
    SELECT MIN(YEAR) FROM CAR_DATA; #FIRST MODEL CAR
    SELECT COUNT(CAR_NAME) FROM CAR_DATA; #COUNT OF CAARS
    
SELECT  MAX(KMS_DRIVEN) FROM CAR_DATA; #500000
SELECT MIN(KMS_DRIVEN) FROM CAR_DATA; #500


SELECT COUNT(DISTINCT YEAR) FROM CAR_DATA;



SELECT DISTINCT FUEL_TYPE FROM CAR_DATA;
SELECT  FUEL_TYPE FROM CAR_DATA;


SELECT DISTINCT CAR_NAME FROM CAR_DATA WHERE CAR_NAME  LIKE  "C%";

SELECT * FROM CAR_DATA WHERE CAR_NAME LIKE "%A";



#############################IMPORTANT##########################################

SELECT COUNT(CAR_NAME) FROM CAR_DATA WHERE YEAR=2013; #33
SELECT COUNT(CAR_NAME) FROM CAR_DATA WHERE YEAR=2014; #38
SELECT COUNT(CAR_NAME) FROM CAR_DATA WHERE YEAR=2015; #61
SELECT COUNT(CAR_NAME) FROM CAR_DATA WHERE YEAR=2016; #50
SELECT COUNT(CAR_NAME) FROM CAR_DATA WHERE YEAR=2017; #35

SELECT COUNT(CAR_NAME) FROM CAR_DATA WHERE YEAR=2016; #50
SELECT COUNT(CAR_NAME) FROM CAR_DATA WHERE YEAR=2016 AND FUEL_TYPE="PETROL"; #42
SELECT COUNT(CAR_NAME) FROM CAR_DATA WHERE YEAR=2016 AND FUEL_TYPE="DIESEL"; #8

SELECT COUNT(CAR_NAME) FROM CAR_DATA WHERE YEAR=2017; #35
SELECT COUNT(CAR_NAME) FROM CAR_DATA WHERE YEAR=2017 AND FUEL_TYPE="PETROL"; #31
SELECT COUNT(CAR_NAME) FROM CAR_DATA WHERE YEAR=2017 AND FUEL_TYPE="DIESEL"; #4



SELECT COUNT(CAR_NAME) FROM CAR_DATA;
SELECT YEAR, COUNT(CAR_NAME) FROM CAR_DATA GROUP BY YEAR ORDER BY YEAR;

SELECT YEAR, FUEL_TYPE, COUNT(CAR_NAME) FROM CAR_DATA 
GROUP BY YEAR, FUEL_TYPE
ORDER BY YEAR;





USE KSR_SQL;
SELECT * FROM ELE_STORE_V1;
SELECT * FROM ELE_STORE_V1 WHERE COUNTRY="INDIA";

#TOTAL SALES MADE BY CHINA
SELECT SUM(SALES) FROM ELE_STORE_V1 WHERE COUNTRY = "CHINA";#7557973.796000007
SELECT SUM(SALES) FROM ELE_STORE_V1 WHERE COUNTRY = "RUSSIA";#434240.25889999996
SELECT SUM(SALES) FROM ELE_STORE_V1 WHERE COUNTRY = "INDIA";#598404.6095

SELECT COUNTRY, SUM(SALES) FROM ELE_STORE_V1 GROUP BY COUNTRY;

SELECT CHANNEL,SUM(SALES) FROM ELE_STORE_V1 
WHERE COUNTRY="CHINA"
GROUP BY CHANNEL;


SELECT COUNTRY, COUNT(ORDERID) FROM ELE_STORE_V1
GROUP BY COUNTRY
ORDER BY COUNT(ORDERID) DESC;


SELECT CITIES, SUM(SALES) FROM ELE_STORE_V1 
WHERE COUNTRY = "INDIA"
GROUP BY CITIES;

SELECT PRODUCTCATEGORY, SUM(SALES) 
FROM ELE_STORE_V1 
GROUP BY PRODUCTCATEGORY
ORDER BY SUM(SALES)  DESC;


SELECT REGION, SUM(ORDERQTY) FROM ELE_STORE_V1 
GROUP BY REGION
ORDER BY SUM(ORDERQTY) DESC;
